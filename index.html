<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <title>YY3 STEAM HKDSE 衝刺計劃</title>
    
    <!-- Google Fonts: Inter & Noto Sans TC -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Tailwind CSS Dark Mode Configuration
      tailwind.config = {
        darkMode: 'class',
      }
    </script>
    
    <!-- PWA Manifest (Embedded) & Theme -->
    <link id="manifest-link" rel="manifest">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#1f2937" media="(prefers-color-scheme: dark)">
    <link id="apple-touch-icon" rel="apple-touch-icon">

    <style>
        /* 基本樣式與動畫 */
        body { 
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent; /* 移除行動裝置點擊高亮 */
        }
        .page { 
            display: none; /* 所有頁面預設隱藏 */
        }
        .page.active { 
            animation: fadeIn 0.5s ease-in-out; 
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex; justify-content: center; align-items: center;
            z-index: 50; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-backdrop.active { opacity: 1; visibility: visible; }
        .modal-content { transform: scale(0.95); transition: transform 0.3s ease; }
        .modal-backdrop.active .modal-content { transform: scale(1); }

        /* 日曆樣式 */
        .calendar-grid { 
            grid-template-columns: repeat(7, minmax(0, 1fr));
        }
        .calendar-day-cell {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-top: 4px;
            align-items: center;
            position: relative;
            aspect-ratio: 1 / 1;
        }
        .record-indicator {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #27ae60;
        }
        html.dark .record-indicator { background-color: #58d68d; }
        .dse-subject-text {
            font-size: 0.65rem;
            line-height: 1;
            margin-top: 2px;
            color: #c0392b;
            font-weight: bold;
            text-align: center;
        }
        html.dark .dse-subject-text { color: #f87171; }
        
        /* 載入中動畫 */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex; justify-content: center; align-items: center;
            z-index: 100; opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        #loader.active { opacity: 1; visibility: visible; }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #fff;
            width: 40px; height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <!-- 載入中動畫 -->
    <div id="loader"><div class="spinner"></div></div>

    <!-- 主容器 -->
    <div id="app" class="max-w-4xl mx-auto min-h-screen bg-white dark:bg-gray-800">

        <!-- 登入頁面 -->
        <div id="login-page" class="page">
            <div class="min-h-screen flex flex-col bg-white dark:bg-gray-900 p-6">
                <header class="flex justify-between items-center mb-16">
                    <div>
                        <h1 class="text-xl font-bold text-blue-600 dark:text-blue-400">YY3 STEAM</h1>
                        <h2 class="text-lg text-gray-800 dark:text-gray-200">HKDSE 衝刺計劃</h2>
                    </div>
                    <button id="login-theme-toggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"></button>
                </header>
                
                <main class="flex-grow flex flex-col justify-center text-center">
                    <div class="mb-10">
                        <p class="text-lg text-gray-500 dark:text-gray-400">距離 HKDSE 尚餘</p>
                        <div id="countdown-timer" class="text-7xl font-bold text-blue-600 dark:text-blue-400 my-2">--</div>
                        <p class="text-lg text-gray-500 dark:text-gray-400">日</p>
                    </div>

                    <div class="w-full max-w-sm mx-auto">
                        <div class="mb-4">
                            <label class="block text-left text-gray-600 dark:text-gray-400 mb-1 ml-1">帳號 ID</label>
                            <input id="login-id" type="text" class="w-full px-4 py-3 border-none rounded-lg bg-gray-100 dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="mb-6">
                             <label class="block text-left text-gray-600 dark:text-gray-400 mb-1 ml-1">密碼</label>
                            <input id="login-password" type="password" class="w-full px-4 py-3 border-none rounded-lg bg-gray-100 dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <button id="login-button" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 dark:hover:bg-blue-500 transition-colors">登入</button>
                        <p id="motivational-quote" class="text-gray-500 dark:text-gray-400 italic mt-6"></p>
                        <p id="login-error" class="text-red-500 dark:text-red-400 mt-4 h-5"></p>
                    </div>
                </main>

                <footer class="text-center text-xs text-gray-400 dark:text-gray-500 py-4">
                    <p>Lonely Chan & AI 共同開發</p>
                </footer>
            </div>
        </div>

        <!-- 學生/管理員主頁面 (自適應高度佈局) -->
        <div id="main-page" class="page flex-col h-screen">
            <header class="px-4 py-3 flex justify-between items-center sticky top-0 z-10 flex-shrink-0 border-b border-gray-200 dark:border-gray-700">
                <div id="header-left" class="flex items-center gap-2 overflow-hidden">
                    <h1 id="main-title" class="text-xl font-bold truncate">溫習日曆</h1>
                    <div id="admin-controls" class="hidden">
                        <select id="student-selector" class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 text-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="">選擇學生</option>
                        </select>
                    </div>
                </div>
                <div class="flex items-center space-x-1">
                    <button id="stats-button" title="統計" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>
                    </button>
                    <button id="main-theme-toggle" title="切換主題" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"></button>
                    <button id="logout-button" class="font-semibold text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-500 transition px-3 py-2 text-sm">登出</button>
                </div>
            </header>

            <main class="p-4 flex flex-col flex-grow">
                <div class="flex justify-between items-center mb-4 flex-shrink-0">
                    <button id="prev-month" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">&lt;</button>
                    <h2 id="current-month-year" class="text-2xl font-bold"></h2>
                    <button id="next-month" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">&gt;</button>
                </div>

                <div class="grid calendar-grid gap-x-1 text-center font-semibold text-gray-600 dark:text-gray-400 mb-2 flex-shrink-0">
                    <div>日</div><div>一</div><div>二</div><div>三</div><div>四</div><div>五</div><div>六</div>
                </div>
                <div id="calendar-body" class="grid calendar-grid gap-x-1 gap-y-0 flex-grow"></div>
            </main>
        </div>
    </div>

    <!-- 溫習紀錄 Modal (v8.2 設計) -->
    <div id="record-modal" class="modal-backdrop">
        <div class="modal-content bg-gray-100 dark:bg-gray-900 w-full max-w-lg m-4 p-6 rounded-2xl shadow-xl max-h-[90vh] flex flex-col">
            <header class="flex justify-between items-center mb-4 flex-shrink-0">
                 <h3 id="modal-title" class="text-xl font-bold"></h3>
                 <button id="close-record-modal" class="text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white text-2xl font-bold">&times;</button>
            </header>
            <div id="record-list" class="flex-grow overflow-y-auto pr-2"></div>
            <div id="add-item-wrapper" class="mt-3 flex-shrink-0">
                <button id="add-record-item" class="w-full border-2 border-dashed border-gray-400 dark:border-gray-600 text-gray-500 dark:text-gray-400 rounded-lg py-3 hover:bg-gray-200 dark:hover:bg-gray-800 transition font-semibold text-sm">
                    + 新增項目
                </button>
            </div>
            <div id="modal-actions" class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-end gap-2 flex-shrink-0">
                 <p id="record-error" class="text-red-500 text-sm mr-auto"></p>
                 <button id="clear-records-btn" class="bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition font-semibold text-sm">清空本日</button>
                 <button id="save-records" class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition font-semibold text-sm">儲存</button>
            </div>
             <div id="admin-modal-footer" class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 text-center hidden flex-shrink-0">
                <p id="record-modal-info" class="text-center text-gray-500">管理員唯讀模式</p>
            </div>
        </div>
    </div>
    
    <!-- 統計 Modal -->
    <div id="stats-modal" class="modal-backdrop">
        <div class="modal-content bg-white dark:bg-gray-800 w-full max-w-lg m-4 p-6 rounded-2xl shadow-xl max-h-[90vh] flex flex-col">
            <h3 id="stats-modal-title" class="text-2xl font-bold mb-2 text-center"></h3>
            <p id="stats-user-id" class="text-center text-gray-500 dark:text-gray-400 mb-4"></p>
            <p class="text-center text-lg mb-4">總時數: <span id="total-hours" class="font-bold text-blue-600 dark:text-blue-400">0</span> 小時</p>
            <div class="w-full max-w-xs mx-auto flex-shrink-0"><canvas id="subject-chart"></canvas></div>
            <div id="stats-details-list" class="mt-6 text-left flex-grow overflow-y-auto pr-2"></div>
            <div class="mt-6 text-center flex-shrink-0">
                <button id="close-stats-modal" class="bg-gray-500 dark:bg-gray-600 text-white py-2 px-6 rounded-lg hover:bg-gray-600 dark:hover:bg-gray-500 transition font-semibold">關閉</button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 設定 ---
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbzMAAGK8egg_0xodccJFgJRxtl97nqJDoHZvbx9wo_iT4sgXTgHtwzYc1AEVICtBSbD4Q/exec';

        // --- 全局變數和常數 ---
        const DSE_TARGET_DATE = new Date('2026-04-09T00:00:00');
        const QUOTES = ["每一次的努力，都是未來最好的鋪墊。", "堅持下去，不是因為你會成功，而是因為你不想後悔。", "成功的路上並不擁擠，因為堅持的人不多。", "今天你所受的苦，會照亮你未來的路。", "別讓現在的懶，變成未來的難。", "天賦決定上限，努力決定下限。", "你必須很努力，才能看起來毫不費力。"];
        const SUBJECTS = ["中文", "英文", "數學", "物理", "化學", "生物", "M2", "中史", "西史", "地理", "經濟", "旅款", "企會財", "ICT", "VA"];
        const DSE_EXAM_DATES = {'2026-04-08':'視覺藝術', '2026-04-09':'中文', '2026-04-10':'英文(一)(二)', '2026-04-11':'英文(三)', '2026-04-13':'數學', '2026-04-14':'公社', '2026-04-16':'化學', '2026-04-20':'生物', '2026-04-22':'物理', '2026-04-23':'地理', '2026-04-24':'ICT', '2026-04-25':'歷史', '2026-04-27':'企會财', '2026-04-29':'中史', '2026-04-30':'M2', '2026-05-02':'旅款', '2026-05-04':'經濟'};
        const CHART_COLORS_LIGHT = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#8BC34A', '#F44336', '#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#03A9F4', '#009688', '#CDDC39'];
        const CHART_COLORS_DARK = ['#d65773', '#5daeec', '#e3b84e', '#66c9c9', '#ad8cfa', '#e38f38', '#a0ce68', '#dc5a50', '#d13c70', '#b04abf', '#815ec7', '#6072c0', '#2cb4dc', '#2ca598', '#d3e05a'];

        let state = {
            currentUser: null, currentDate: new Date(), studentData: {},
            viewingStudentId: null, chartInstance: null,
        };
        
        // --- DOM 元素 ---
        const loader = document.getElementById('loader');
        const pages = document.querySelectorAll('.page');
        const countdownTimerEl = document.getElementById('countdown-timer');
        const quoteEl = document.getElementById('motivational-quote');
        const loginIdEl = document.getElementById('login-id');
        const loginPasswordEl = document.getElementById('login-password');
        const loginButton = document.getElementById('login-button');
        const loginErrorEl = document.getElementById('login-error');
        const currentMonthYearEl = document.getElementById('current-month-year');
        const calendarBodyEl = document.getElementById('calendar-body');
        const recordModal = document.getElementById('record-modal');
        const statsModal = document.getElementById('stats-modal');
        const themeToggleButtons = [document.getElementById('login-theme-toggle'), document.getElementById('main-theme-toggle')];

        // --- 後端服務 ---
        const callGas = async (action, payload = {}) => {
            if (GAS_URL.includes('在此貼上')) {
                alert('錯誤：尚未設定 Google Apps Script Web App 網址！請在 index.html 檔案中找到 GAS_URL 變數，並貼上你的後端網址。');
                throw new Error('GAS_URL not configured.');
            }
            loader.classList.add('active');
            try {
                const response = await fetch(GAS_URL, {
                    method: 'POST', body: JSON.stringify({ action, payload }),
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                });
                const result = await response.json();
                if (!result.success) throw new Error(result.message);
                return result.data;
            } catch (error) {
                console.error('GAS Call Error:', error);
                alert(`與伺服器通訊失敗: ${error.message}`);
                throw error;
            } finally {
                loader.classList.remove('active');
            }
        };

        const gasService = {
            login: (id, password) => callGas('login', { id, password }),
            getStudentData: (studentId) => callGas('getStudentData', { studentId }),
            saveStudentData: (studentId, dateKey, data) => callGas('saveStudentData', { studentId, dateKey, data }),
            getAllStudents: () => callGas('getAllStudents'),
        };

        // --- 核心函式 ---
        const showPage = (pageId) => {
            pages.forEach(p => {
                p.classList.remove('active');
                p.style.display = 'none'; 
            });
            const activePage = document.getElementById(pageId);
            activePage.classList.add('active');
            if (pageId === 'main-page') {
                activePage.style.display = 'flex'; 
            } else {
                activePage.style.display = 'block';
            }
        };

        const updateCountdown = () => {
            const diff = DSE_TARGET_DATE - new Date();
            if (diff <= 0) { countdownTimerEl.textContent = "✓"; return; }
            const days = Math.floor(diff / 86400000);
            countdownTimerEl.textContent = days;
        };
        
        const renderCalendar = () => {
            calendarBodyEl.innerHTML = '';
            const year = state.currentDate.getFullYear();
            const month = state.currentDate.getMonth();
            currentMonthYearEl.textContent = `${year}年 ${month + 1}月`;
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let i = 0; i < firstDay; i++) calendarBodyEl.innerHTML += `<div></div>`;
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const today = new Date();
                const isToday = year === today.getFullYear() && month === today.getMonth() && day === today.getDate();
                const hasRecord = state.studentData[dateKey] && JSON.parse(state.studentData[dateKey]).length > 0;
                const isDseDay = DSE_EXAM_DATES[dateKey];

                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day-cell cursor-pointer rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50';
                dayEl.dataset.date = dateKey;
                
                let dayNumberClass = isToday ? "bg-blue-600 text-white font-bold" : "";
                let content = `<span class="w-8 h-8 flex items-center justify-center rounded-full transition-colors ${dayNumberClass}">${day}</span>`;
                
                if(isDseDay) content += `<span class="dse-subject-text">${isDseDay}</span>`;
                if(hasRecord) content += `<div class="record-indicator" title="有溫習紀錄"></div>`;
                
                dayEl.innerHTML = content;
                dayEl.addEventListener('click', () => handleDateClick(dateKey));
                calendarBodyEl.appendChild(dayEl);
            }
        };
        
        const handleDateClick = (dateKey) => {
            const data = state.studentData[dateKey] ? JSON.parse(state.studentData[dateKey]) : [];
            const isReadOnly = state.currentUser.role === 'admin';
            if (!isReadOnly || (isReadOnly && data.length > 0)) openRecordModal(dateKey, data, isReadOnly);
        };
        
        const openRecordModal = (dateKey, records, isReadOnly) => {
            const viewingId = isReadOnly ? state.viewingStudentId : state.currentUser.id;
            document.getElementById('modal-title').textContent = `${viewingId} 於 ${dateKey} 的紀錄`;
            const recordList = document.getElementById('record-list');
            recordList.innerHTML = '';
            recordList.dataset.date = dateKey;

            // 修正 2: 當沒有紀錄時，不再預設增加一個輸入框
            records.forEach(r => addRecordItem(recordList, r, isReadOnly));
            
            const recordErrorEl = document.getElementById('record-error');
            if(recordErrorEl) recordErrorEl.textContent = '';


            document.getElementById('add-item-wrapper').classList.toggle('hidden', isReadOnly);
            document.getElementById('modal-actions').classList.toggle('hidden', isReadOnly);
            document.getElementById('admin-modal-footer').classList.toggle('hidden', !isReadOnly);
            
            recordModal.classList.add('active');
        };

        const addRecordItem = (container, item = {subject: SUBJECTS[0], hours: '', content: ''}, isReadOnly = false) => {
            const itemEl = document.createElement('div');
            const subjectOptions = SUBJECTS.map(s => `<option value="${s}" ${item.subject === s ? 'selected' : ''}>${s}</option>`).join('');

            if (isReadOnly) {
                itemEl.className = 'record-item bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm mb-3';
                itemEl.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h4 class="text-base font-bold text-blue-600 dark:text-blue-400">${item.subject}</h4>
                        <span class="font-semibold text-sm">${item.hours} 小時</span>
                    </div>
                    <p class="mt-1 text-gray-600 dark:text-gray-400 text-sm">${item.content || '<i>無內容</i>'}</p>
                `;
            } else {
                itemEl.className = 'record-item bg-white dark:bg-gray-800 p-3 rounded-xl shadow-sm mb-3 relative';
                itemEl.innerHTML = `
                    <button class="delete-item-btn absolute top-2 right-2 text-gray-400 hover:text-red-500 text-xl transition-colors">&times;</button>
                    <div class="flex items-center gap-2 mb-2">
                        <select class="subject h-10 flex-1 bg-gray-200 dark:bg-gray-700 border-none rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500">${subjectOptions}</select>
                        <input type="number" step="0.01" class="hours h-10 w-24 bg-gray-200 dark:bg-gray-700 border-none rounded-lg p-2 text-sm text-center focus:ring-2 focus:ring-blue-500" placeholder="時數" value="${item.hours}">
                    </div>
                    <div>
                        <textarea class="content w-full bg-gray-200 dark:bg-gray-700 border-none rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500" rows="2" placeholder="溫習內容...">${item.content || ''}</textarea>
                    </div>
                `;
                 itemEl.querySelector('.delete-item-btn').addEventListener('click', () => itemEl.remove());
            }
            container.appendChild(itemEl);
        };

        const openStatsModal = () => {
            const year = state.currentDate.getFullYear(), month = state.currentDate.getMonth() + 1;
            document.getElementById('stats-modal-title').textContent = `${year}年 ${month}月 溫習統計`;

            const monthKey = `${year}-${String(month).padStart(2, '0')}`;
            let totalHours = 0;
            const subjectHours = {};
            Object.keys(state.studentData).forEach(dateKey => {
                if (dateKey.startsWith(monthKey) && state.studentData[dateKey]) {
                    try {
                        JSON.parse(state.studentData[dateKey]).forEach(r => {
                            const hours = parseFloat(r.hours) || 0;
                            totalHours += hours;
                            subjectHours[r.subject] = (subjectHours[r.subject] || 0) + hours;
                        });
                    } catch (e) { console.error("無法解析統計數據:", state.studentData[dateKey]); }
                }
            });

            document.getElementById('total-hours').textContent = totalHours.toFixed(2);
            document.getElementById('stats-user-id').textContent = state.currentUser.role === 'admin' ? `學生: ${state.viewingStudentId}` : '';
            
            const statsDetailsList = document.getElementById('stats-details-list');
            statsDetailsList.innerHTML = '';
            if (totalHours > 0) {
                const sortedSubjects = Object.entries(subjectHours).sort(([, a], [, b]) => b - a);
                sortedSubjects.forEach(([subject, hours]) => {
                    const percentage = ((hours / totalHours) * 100).toFixed(1);
                    const detailEl = document.createElement('div');
                    detailEl.className = 'flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-700 text-sm';
                    detailEl.innerHTML = `<span>${subject}</span><span class="font-semibold text-right">${hours.toFixed(2)} 小時<br><span class="text-xs text-gray-500 dark:text-gray-400">(${percentage}%)</span></span>`;
                    statsDetailsList.appendChild(detailEl);
                });
            } else {
                statsDetailsList.innerHTML = '<p class="text-center text-gray-500">本月暫無紀錄</p>';
            }

            if (state.chartInstance) state.chartInstance.destroy();
            const isDarkMode = document.documentElement.classList.contains('dark');
            Chart.defaults.color = isDarkMode ? '#ddd' : '#666';
            state.chartInstance = new Chart(document.getElementById('subject-chart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(subjectHours),
                    datasets: [{ 
                        data: Object.values(subjectHours), 
                        backgroundColor: isDarkMode ? CHART_COLORS_DARK : CHART_COLORS_LIGHT,
                        borderColor: isDarkMode ? 'rgb(31 41 55)' : 'rgb(255, 255, 255)', 
                        borderWidth: 2
                    }]
                },
                options: { responsive: true, maintainAspectRatio: true, plugins: { legend: { display: Object.keys(subjectHours).length > 0, position: 'bottom' } } }
            });
            statsModal.classList.add('active');
        };

        // --- 登入/登出/管理員邏輯 ---
        async function login() {
            const id = loginIdEl.value.trim(), password = loginPasswordEl.value.trim();
            if (!id || !password) { loginErrorEl.textContent = '請輸入 ID 和密碼'; return; }
            loginErrorEl.textContent = '';
            try {
                const result = await gasService.login(id, password);
                state.currentUser = { id: result.id, role: result.role };
                if (result.role === 'student') {
                    state.viewingStudentId = result.id;
                    document.getElementById('admin-controls').classList.add('hidden');
                    document.getElementById('main-title').textContent = `${result.id} 的溫習日曆`;
                    await loadStudentData(result.id);
                } else if (result.role === 'admin') {
                    document.getElementById('admin-controls').classList.remove('hidden');
                    document.getElementById('main-title').textContent = '管理員面板';
                    await setupAdminPage();
                }
                showPage('main-page');
            } catch (error) {
                loginErrorEl.textContent = error.message;
            }
        }

        async function loadStudentData(studentId) { 
            state.studentData = await gasService.getStudentData(studentId); 
            renderCalendar(); 
        }
        async function setupAdminPage() {
            const students = await gasService.getAllStudents();
            const selector = document.getElementById('student-selector');
            selector.innerHTML = '<option value="">選擇學生</option>';
            students.forEach(id => selector.add(new Option(id, id)));
            state.studentData = {}; 
            renderCalendar();
        }

        function logout() {
            state = { ...state, currentUser: null, studentData: {}, viewingStudentId: null };
            loginIdEl.value = ''; 
            loginPasswordEl.value = ''; 
            loginErrorEl.textContent = '';
            showPage('login-page');
        }

        // --- 主題切換 ---
        const sunIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>`;
        const moonIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>`;
        const applyTheme = (theme) => {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                themeToggleButtons.forEach(btn => btn.innerHTML = sunIcon);
            } else {
                document.documentElement.classList.remove('dark');
                themeToggleButtons.forEach(btn => btn.innerHTML = moonIcon);
            }
        };
        const toggleTheme = () => {
            const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        };
        themeToggleButtons.forEach(btn => btn.addEventListener('click', toggleTheme));

        // --- 事件監聽器 ---
        loginButton.addEventListener('click', login);
        loginPasswordEl.addEventListener('keyup', (e) => { if(e.key === 'Enter') login(); });
        document.getElementById('logout-button').addEventListener('click', logout);
        document.getElementById('stats-button').addEventListener('click', openStatsModal);
        document.getElementById('close-stats-modal').addEventListener('click', () => statsModal.classList.remove('active'));
        document.getElementById('prev-month').addEventListener('click', () => { state.currentDate.setMonth(state.currentDate.getMonth() - 1); renderCalendar(); });
        document.getElementById('next-month').addEventListener('click', () => { state.currentDate.setMonth(state.currentDate.getMonth() + 1); renderCalendar(); });
        document.getElementById('close-record-modal').addEventListener('click', () => recordModal.classList.remove('active'));
        document.getElementById('add-record-item').addEventListener('click', () => addRecordItem(document.getElementById('record-list')));
        
        document.getElementById('clear-records-btn').addEventListener('click', () => {
            const recordList = document.getElementById('record-list');
            recordList.innerHTML = '';
        });

        document.getElementById('save-records').addEventListener('click', async () => {
            const recordList = document.getElementById('record-list');
            const recordErrorEl = document.getElementById('record-error');
            recordErrorEl.textContent = ''; // 重設錯誤訊息

            const dataToSaveRaw = Array.from(recordList.querySelectorAll('.record-item')).map(item => ({
                subject: item.querySelector('.subject').value,
                hours: parseFloat(item.querySelector('.hours').value) || 0,
                content: item.querySelector('.content').value.trim(),
            }));

            // 修正 1: 前端驗證，檢查是否有時數為0的項目
            if (dataToSaveRaw.length > 0 && dataToSaveRaw.some(item => item.hours <= 0)) {
                recordErrorEl.textContent = '警告：時數不能為 0。';
                return; // 中斷儲存
            }
            
            const dataToSave = dataToSaveRaw.filter(item => item.hours > 0);
            
            await gasService.saveStudentData(state.viewingStudentId, recordList.dataset.date, JSON.stringify(dataToSave));
            await loadStudentData(state.viewingStudentId);
            recordModal.classList.remove('active');
        });

        document.getElementById('student-selector').addEventListener('change', async (e) => {
            const studentId = e.target.value;
            state.viewingStudentId = studentId;
            if (studentId) {
                document.getElementById('main-title').textContent = `${studentId} 的溫習日曆`;
                await loadStudentData(studentId);
            } else {
                document.getElementById('main-title').textContent = '管理員面板';
                state.studentData = {}; 
                renderCalendar();
            }
        });

        // --- 初始化 ---
        const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyTheme(savedTheme);

        // 更新 Manifest
        const customIconBase64 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAFaAVoDASIAAhEBAxEB/8QAGgABAAIDAQAAAAAAAAAAAAAAAAEFAgMEBv/EABcBAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAr4ZAAAAAAAAAAAAAACCdFZyS2GndvOXq18heT5y8reEAAAAAAAAAAAAAAAAUffWS77eQAByU3pK47tlJd2AAAAAAAAAAAAAAAAUNjTeilmvwqj1M8nWYxQZHoIkeb9HS2J1iwAAAAAAAAAAAAiQADzHpfP3MvBwelENI853WHUZgp+6ruDeLAAAAABiZKusPR8nnJW61VYs5qxddfmYPZV1J3pV2tTK+wmptkAq9Nx5yX0bj7Cr03UkSDn20BHpOPsoEAAAAY8NCWtTGS45TBKJETBIISIw2QatsST63xvcekU1om3RvHmrKwp5bmfN3Z04ZURhYZWAFgAAglX15cUnDkuGyQABCYEhEwExIiYCYEZQYTkLuz8bdluEreO0qpbaovPPHpJxysAAAV9gPG52tMu1jmAIkEASCCQRIISQmASRMBr2QX9h5L1aPO+k1rX4cFjGdlWWYFgADHKgObRGapnZLqjbqApEkiYEwkiYAExEkwAEwAGF9R9R6UhPPRsuZc8ywAADi830alkgy2akuUQTbpmFmCwYGcxJCIMjAjPo5pc4LAACYGOWo9mwzQAAABx9lEVezEszjIAYZiYDFvl5sujQTEZphF3RLn14XUsed9VUxXMM95AAAas8Du28cFt3eZxT2Lzd8bgAPMen88cGOzBc4mCcWZrz1jZr22svHa5bcb8tNx0azXWOzZnWGjsGjdIY5E89y+ootTnYZazLETAMM8TekAYxniem3eZ9MgAHB530/l1zjLAi8q77G6rq7cpdOzYASEiJCJgEgiSIyHnee0qt5kWCBOORuRIABo9T5m6LQIBHk/W05U4i2VvwZ412PP7C9VvWu8QiRExqNyv57LjGh5a9Bu8vdFkM3joPUeW1nKIu7OLZcs68zuvvPamMeiq7ORp3AGFhw9J6IIAiR5TT6nzS23RyWeNUPJ6lXk59RzJT+i4LCXKJS8FF6PCvPz6LoufPdtpMujeSgPLeo89qZX/LtjRz5dmekaeibmuuvO+j3zpqr1vm61sciNuvI9QEAA1+XtdEuNz570OdSxylQEghMExIRrzMkCTEyBGrcI4+3hXLbhnNThtq9Yxvq2y1hzdI8ju26Kyyxk9SEAA891aNmd8F/U98VfP6Wts48eVZ0+jorzOpEsJgouP09FrMRzRZn1ZXEuyYnOgIxyGvLLmXOgm+3jpyEAraX0vlzohlXqAhT5lry81MZxe6JeKwob6a64M65tXdNmMzjGTk6lEpEZCswtosxyTLEghzHJq5e/eeONvYnZ0xIwzwEVndKob6nNGWvZqeoCUmHc5daD0Pm9/Tn6TZQYL17K3aXhONiElEkSgkAETEggmJ5CajTZ7zZ7K3vTPg7xR3lbBaI5zz/THXnXPy2OBWbevGy56POeis4Kvursb3XUcVd8TjE+d9FjZwWNLpr0Lk6s2UCdWmsstJ4JLTOl7DuRWS2XLV9OpjzWvXFd19BeKuvsEw6fPeg1J896GlS6oMsF6+iJ5dAAjPs07+vOkw7aSat+iiuTLXwWJ1cvFxJZ6NOitPR37I09PHoLrb5vCvUT5ST1OvzcHXtWxlNZZ5suTqJABXbuSdZt/P7dBu708+gAgnOO3WZHTnXRM8e3Hz2kWV2q2lOHb0wunZmlhIiMkYpmsYzgxrbXhs6sK6x3ns47Cpl7emJjDLy2Gs+kquHcZbLLZnXJ1zGdSgSiRnhYazEnTmB//aAAwDAQACAAMAAAAh9999999999999995Wz/019999999999999995CCDDz5999999999999999pnHjTS+999999999999559pP5S3DG9999995hwE8oTo5t+3bjdE99995tUFJVBx19s1VGNPqd995lghBB1htpV1FpgFzth9995IRBRN5FBhZ15t9l8vOd99xBSqIRtZt9dd9d98hz999pAFyDWd1p59Cd9919d9999BBp9Ft2qzxdbR999cO9T99xYBpdd+FxggB2VZyW2CEZ9t81aKwDBhtxJhiuEtKKk899tBx+EDTmNQQBPPXECI+gd9tov83+Rpr7iBIlhm6Y+0V95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";

        const manifest = {
            "name": "YY3 STEAM HKDSE 衝刺計劃",
            "short_name": "STEAM衝刺",
            "description": "一個為 YY3 STEAM 設計的HKDSE溫習進度追蹤工具",
            "start_url": ".",
            "display": "standalone",
            "background_color": "#ffffff",
            "theme_color": "#ffffff",
            "orientation": "portrait-primary",
            "icons":[
                {
                    "src": customIconBase64,
                    "type": "image/jpeg",
                    "sizes":"192x192"
                },
                {
                    "src": customIconBase64,
                    "type": "image/jpeg",
                    "sizes":"512x512"
                }
            ]
        };
        document.getElementById('manifest-link').href = URL.createObjectURL(new Blob([JSON.stringify(manifest)], {type: 'application/json'}));
        document.getElementById('apple-touch-icon').href = customIconBase64;

        quoteEl.textContent = `“${QUOTES[Math.floor(Math.random() * QUOTES.length)]}”`;
        setInterval(updateCountdown, 3600000); 
        updateCountdown();
        showPage('login-page');
    });
    </script>
</body>
</html>


